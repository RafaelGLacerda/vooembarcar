<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
   <link rel="icon" href="img/logo4.png" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Solicitar CotaÃ§Ã£o</title>
  <link rel="stylesheet" href="cotacao.css">
</head>
<body>
  <div class="container">
    <h1>Solicite sua CotaÃ§Ã£o</h1>
    <form id="cotacaoForm">


      <div class="input-wrapper">
        <input type="text" name="nome" maxlength="50" placeholder="Nome" oninput="atualizaContador(this, 'nomeCount')" required />
        <span class="char-counter" id="nomeCount">0/50</span>
      </div>


      <div class="input-wrapper">
        <input type="text" name="origem" maxlength="50" placeholder="Origem" oninput="atualizaContador(this, 'origemCount')" required />
        <span class="char-counter" id="origemCount">0/50</span>
      </div>


      <div class="input-wrapper">
        <input type="text" name="destino" maxlength="50" placeholder="Destino" oninput="atualizaContador(this, 'destinoCount')" required />
        <span class="char-counter" id="destinoCount">0/50</span>
      </div>

      <label class="test">Data de ida:
        <input type="date" name="dataIda" id="dataIda" required onchange="atualizaDataVoltaMin()" />
      </label>

      <label id="voltaLabel">Data de volta:
        <input type="date" name="dataVolta" id="dataVolta" onchange="verificaDatas()" />
      </label>

      <label class="checkbox-row">
        <input type="checkbox" id="somenteIda" onchange="toggleVolta()" /> Somente ida
      </label>

      <label class="checkbox-row2">
        <input type="checkbox" id="flexivel" name="flexivel" value="Sim" />
        <span>Tenho flexibilidade nas datas</span>
        <div class="tooltip-wrapper" aria-label="Ajuda">
          <div class="circle-icon">?</div>
          <div class="tooltip-box">Flexibilidade significa considerar datas prÃ³ximas Ã  desejada, aumentando as chances
            de encontrar melhores preÃ§os.</div>
        </div>
      </label>

      <label>NÃºmero de passageiros:
        <select name="passageiros" required>
          <option value="" disabled selected>Selecione</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
        </select>
        <span id="criancaInfo" class="info-msg"></span>
      </label>

      <div class="botoes">
        <button type="submit">Enviar via WhatsApp</button>
        <a href="index.html" class="voltar-btn">Voltar</a>
      </div>
    </form>
  </div>

  <script>
    function atualizaContador(input, counterId) {
      const count = input.value.length;
      document.getElementById(counterId).textContent = `${count}/50`;
    }

    function toggleVolta() {
      const checkbox = document.getElementById("somenteIda");
      const voltaLabel = document.getElementById("voltaLabel");
      const dataVolta = document.getElementById("dataVolta");

      if (checkbox.checked) {
        voltaLabel.style.display = "none";
        dataVolta.value = ""; // Limpa a data de volta
      } else {
        voltaLabel.style.display = "block";
      }
    }

    function atualizaDataVoltaMin() {
      const dataIda = document.getElementById("dataIda").value;
      const dataVolta = document.getElementById("dataVolta");
      dataVolta.min = dataIda;
    }

    function verificaDatas() {
      const dataIda = document.getElementById("dataIda").value;
      const dataVolta = document.getElementById("dataVolta").value;
      if (dataVolta && dataIda && dataVolta < dataIda) {
        alert("A data de volta nÃ£o pode ser anterior Ã  data de ida.");
        document.getElementById("dataVolta").value = "";
      }
    }

    // Impede seleÃ§Ã£o de datas anteriores a hoje
    window.addEventListener("DOMContentLoaded", () => {
      const hoje = new Date().toISOString().split("T")[0];
      document.getElementById("dataIda").min = hoje;
      document.getElementById("dataVolta").min = hoje;
    });

    // Controle da mensagem de aviso da crianÃ§a
    const selectPassageiros = document.querySelector('select[name="passageiros"]');
    const criancaInfo = document.getElementById("criancaInfo");

    function mostraAviso() {
      criancaInfo.textContent = "ğŸ‘¶ CrianÃ§as de atÃ© 1 ano e 11 meses nÃ£o pagam.";
    }

    function escondeAviso() {
      criancaInfo.textContent = "";
    }

    selectPassageiros.addEventListener("focus", mostraAviso);

    // Esconder aviso ao clicar fora do select
    document.addEventListener("click", (event) => {
      if (!selectPassageiros.contains(event.target)) {
        escondeAviso();
      }
    });

    // Esconder aviso ao perder foco via teclado (tab)
    selectPassageiros.addEventListener("blur", () => {
      setTimeout(() => {
        if (document.activeElement !== selectPassageiros) {
          escondeAviso();
        }
      }, 100);
    });

function formatarDataBR(dataISO) {
  if (!dataISO) return "";
  const partes = dataISO.split("-");
  if (partes.length !== 3) return dataISO; // fallback caso formato invÃ¡lido
  return `${partes[2]}/${partes[1]}/${partes[0]}`;
}

document.getElementById("cotacaoForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const form = new FormData(e.target);
  const nome = form.get("nome");
  const origem = form.get("origem");
  const destino = form.get("destino");
  const dataIdaISO = form.get("dataIda");
  const somenteIda = document.getElementById("somenteIda").checked;
  const dataVoltaISO = somenteIda ? "" : form.get("dataVolta");
  const flexivel = form.get("flexivel") ? "Sim" : "NÃ£o";
  const passageiros = form.get("passageiros");

  const dataIda = formatarDataBR(dataIdaISO);
  const dataVolta = somenteIda ? "Somente ida" : (dataVoltaISO ? formatarDataBR(dataVoltaISO) : "NÃ£o informada");

  const mensagem = `
ğŸš€ *SolicitaÃ§Ã£o de CotaÃ§Ã£o* ğŸš€
  
ğŸ‘¤ Nome: ${nome}
ğŸ“ Origem: ${origem}
ğŸ¯ Destino: ${destino}
ğŸ“… Ida: ${dataIda}
ğŸ“… Volta: ${dataVolta}
ğŸ“ˆ FlexÃ­vel nas datas? ${flexivel}
ğŸ§‘ Passageiros: ${passageiros}
  `.trim();

  const numero = "5584999839663";
  const link = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;
  window.open(link, "_blank");
});

  </script>
</body>
</html>
